---
title: "WR_v4_deltaEstimators"
author: "FÃ¡tima S. Barreiro"
date: "November 17, 2020"
output: html_document
---

Load required libraries
```{r message=FALSE, warning=FALSE, paged.print=FALSE}
library(ggplot2)
library(cowplot)
library(ggrepel)
library(reshape2)
library(dplyr)
library(tidyverse)
library(data.table)
require(scales)
library(ggpubr)
library(tidyr)
library(PairedData)
library(gridExtra)
```

Open metadata and genomic metrics table
```{r}
data = read.csv("WR_TableS1_v5.csv", h=T, fill=T, stringsAsFactors=T, fileEncoding="latin1")
```




## GW Het

```{r}
datassHet = subset(data, lab_ID!='mwr_TG0450' & lab_ID!='mwr_TG0451' & lab_ID!='mwr_TG0456' & lab_ID!='mwr_TGF01')
```

```{r}
NWRpreH = datassHet[datassHet$time_window == "NWRpre",]
NWRpostH = datassHet[datassHet$time_window == "NWRpost",]
SWRpreH = datassHet[datassHet$time_window == "SWRpre",]
SWRpostH = datassHet[datassHet$time_window == "SWRpost",]

```


### Median comparisons for GW Het

#### NWR
Group comparison
```{r}
wilcox.test(NWRpreH$gw_het_GL2_5x_ErTv, NWRpostH$gw_het_GL2_5x_ErTv, paired=F, alternative = "greater")
```

#### SWR
```{r}
wilcox.test(SWRpreH$gw_het_GL2_5x_ErTv, SWRpostH$gw_het_GL2_5x_ErTv, paired=F, alternative = "greater")
```

### Delta estimators for GW Het
Delta estimators
```{r}
datassHet$time_window=factor(datassHet$time_window,levels=c("NWRpre","NWRpost","SWRpre", "SWRpost"))
```

```{r}
datassHet %>%
  group_by(time_window) %>%
  summarize(min=min(gw_het_GL2_5x_ErTv), max=max(gw_het_GL2_5x_ErTv), median=median(gw_het_GL2_5x_ErTv))
```



###################################################

## RoH length and FRoH

```{r}
datassF = subset(data, lab_ID!='mwr_TG0450' & lab_ID!='mwr_TG0451' & lab_ID!='mwr_TG0456' & lab_ID!='mwr_TGF01' & lab_ID!='mwr_TG0452' & lab_ID!='mwr_TG0461' & lab_ID!='mwr_TGF02' & lab_ID!='mwr_TGF04')
```

```{r}
NWRpreF = datassF[datassF$time_window == "NWRpre",]
NWRpostF = datassF[datassF$time_window == "NWRpost",]
SWRpreF = datassF[datassF$time_window == "SWRpre",]
SWRpostF = datassF[datassF$time_window == "SWRpost",]

```


### Median comparisons for FRoH

#### NWR
Group comparison
```{r}
wilcox.test(NWRpreF$Froh_10scf, NWRpostF$Froh_10scf, paired=F, alternative = "less")
```

#### SWR
```{r}
wilcox.test(SWRpreF$Froh_10scf, SWRpostF$Froh_10scf, paired=F, alternative = "less")
```



### Delta estimators for FRoH
Delta estimators
```{r}
datassF$time_window=factor(datassF$time_window, levels=c("NWRpre","NWRpost","SWRpre", "SWRpost"))
```

```{r}
datassF %>%
  group_by(time_window) %>%
  summarize(min=min(Froh_10scf), max=max(Froh_10scf), median=median(Froh_10scf))
```


### Median comparisons for average RoH length

#### NWR
Group comparison
```{r}
wilcox.test(NWRpreF$ave_RoH_len, NWRpostF$ave_RoH_len, paired=F, alternative = "less")
```

#### SWR
```{r}
wilcox.test(SWRpreF$ave_RoH_len, SWRpostF$ave_RoH_len, paired=F, alternative = "less")
```



### Delta estimators for FRoH
Delta estimators
```{r}
datassF$time_window=factor(datassF$time_window, levels=c("NWRpre","NWRpost","SWRpre", "SWRpost"))
```

```{r}
datassF %>%
  group_by(time_window) %>%
  summarize(min=min(ave_RoH_len), max=max(ave_RoH_len), median=median(ave_RoH_len))
```

























