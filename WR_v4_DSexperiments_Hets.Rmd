---
title: "Het correlations"
author: "Fátima S. Barreiro"
date: "July 10, 2020"
output: html_document
---




Load required libraries
```{r message=FALSE, warning=FALSE, paged.print=FALSE}
library(ggplot2)
library(cowplot)
library(ggrepel)
library(reshape2)
library(dplyr)
library(tidyverse)
library(data.table)
require(scales)
library(ggpubr)
library(tidyr)
library(PairedData)
library(gridExtra)
```


Reading in file containing metadata and genomic diversity metrics 
```{r}
data = read.csv("WR_TableS1_v5.csv", h=T, fill=T, stringsAsFactors=T, fileEncoding="latin1")
```




### Correlations between different estimates of heterozygosity


```{r}
C1 = ggscatter(data, x = "gw_het_GL1_raw", y = "gw_het_GL1_corrected", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson") + ggtitle("GWhet with GL1 uncorrected vs GWhet with GL1 corrected")

C2 = ggscatter(data, x = "gw_het_GL1_raw", y = "gw_het_GL2", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson") + ggtitle("GWhet with GL1 uncorrected vs GWhet with GL2")

C3 = ggscatter(data, x = "gw_het_GL1_raw", y = "gw_het_GL2", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson") + ggtitle("GWhet with GL1 corrected vs GWhet with GL2")

C4 = ggscatter(data, x = "gw_het_GL2_3x", y = "gw_het_GL2", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson") + ggtitle("GWhet with GL2 and 3x min VS GL2")

C5 = ggscatter(data, x = "gw_het_GL2_3x", y = "gw_het_GL1_raw", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson") + ggtitle("GWhet with GL2 and 3x min VS GL1")

C6 = ggscatter(data, x = "gw_het_GL2_3x", y = "gw_het_GL1_corrected", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson") + ggtitle("GWhet with GL2 and 3x min VS GL1-corrected")



```


```{r}
C4
C5
C6
```


```{r eval=FALSE, include=FALSE}
pdf("WR_Het_GLcorrelations.pdf", height=7, useDingbats = F)
plot_grid(C1, C2, C3, nrow=3, ncol=1)
dev.off
```



### Differences between different estimates of het across samples

```{r}
dataH = data[, c("lab_ID", "gw_het_GL1_raw", "gw_het_GL1_corrected", "gw_het_GL2", "gw_het_GL2_3x", "gw_het_GL2_5x", "gw_het_GL2_3x_ErTv" )]
dataM = reshape2::melt(dataH, id.vars=c("lab_ID"))
head(dataM)
```

```{r}
Hs = ggplot(dataM, aes(lab_ID, value, colour=variable, shape=variable)) + geom_point() + theme_bw() +
  theme(axis.text.x=element_text(angle=80, hjust=1), legend.position = "top", legend.title=element_blank()) + 
  guides(colour=guide_legend(ncol=2)) +
  ylab("Het estimate")

Hs
```

```{r}
pdf("WR_GWhet_estimates.pdf", height=5, useDingbats = F)
Hs
dev.off
```



### Correlations between het and depth of coverage

```{r}
D1 = ggscatter(data, x = "depth_of_coverage", y = "gw_het_GL1_raw", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson") + ggtitle("DoC vs GWhet GL1 uncorrected")

D2 = ggscatter(data, x = "depth_of_coverage", y = "gw_het_GL1_corrected", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson") + ggtitle("DoC vs GWhet GL1 corrected")

D3 = ggscatter(data, x = "depth_of_coverage", y = "gw_het_GL2", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson") + ggtitle("DoC vs GWhet GL2")

D4 = ggscatter(data, x = "depth_of_coverage", y = "gw_het_GL2_3x", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson") + ggtitle("DoC vs GWhet GL2-3x minDoC")

D5 = ggscatter(data, x = "depth_of_coverage", y = "gw_het_GL2_5x", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson") + ggtitle("DoC vs GWhet GL2-5x minDoC")


```


```{r}
D1
D2
D3
D4
D5
```


```{r}
pdf("WR_HetVsDoc.pdf", height=8, width=9, useDingbats = F)
plot_grid(D1, D2, D3, D4, D5, nrow=3, ncol=2, labels=c('A','B','C','D', 'E'))
dev.off
```


```{r}
E1 = ggscatter(data, x = "X5â..CtoT_damage", y = "gw_het_GL1_raw", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson") + ggtitle("Damage vs GWhet GL1 uncorrected")

E2 = ggscatter(data, x = "X5â..CtoT_damage", y = "gw_het_GL1_corrected", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson") + ggtitle("Damage vs GWhet GL1 corrected")

E3 = ggscatter(data, x = "X5â..CtoT_damage", y = "gw_het_GL2", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson") + ggtitle("Damage vs GWhet GL2")

E4 = ggscatter(data, x = "X5â..CtoT_damage", y = "gw_het_GL2_3x", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson") + ggtitle("Damage vs GWhet GL2-3x minDoC")

E5 = ggscatter(data, x = "X5â..CtoT_damage", y = "gw_het_GL2_5x", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson") + ggtitle("Damage vs GWhet GL2-5x minDoC")

```


```{r}
E1
E2
E3
E4
E5
```



```{r eval=FALSE, include=FALSE}
pdf("WR_HetVsDamage.pdf", height=8, width=9, useDingbats = F)
plot_grid(E1, E2, E3, E4, E5, nrow=3, ncol=2, labels=c('A','B','C','D', 'E'))
dev.off
```


###############################################################################################################################

## Downsampling tests

<!-- #### Experiment 1. Medium-depth samples with GL2 with and without 3x depth filter -->

<!-- Read in data table -->
<!-- ```{r} -->
<!-- DSdata = read.csv("GWhet_GL2_DStest.csv", h=T, fill=T, stringsAsFactors=T, fileEncoding="latin1") -->
<!-- ``` -->


<!-- ```{r} -->
<!-- F1 = ggplot(data=DSdata[DSdata$doc_filter == "filter",], aes(depth, het, colour=sample)) + geom_point() + geom_line() + -->
<!--   ylim(limits=c(0,4e-4)) + ggtitle("Downsampling test with a 3x minimum depth per site") + -->
<!--   xlim(limits=c(0,23)) -->

<!-- F2 = ggplot(data=DSdata[DSdata$doc_filter == "no_filter",], aes(depth, het, colour=sample)) + geom_point() + geom_line() + -->
<!--   ylim(limits=c(0,4e-4)) + ggtitle("Downsampling test without filtering depth per site ") + -->
<!--   xlim(limits=c(0,23)) -->

<!-- F1 -->
<!-- F2 -->

<!-- ``` -->


<!-- ```{r} -->
<!-- ggplot(DSdata, aes(depth, proportion_het, colour=sample)) + geom_point() + geom_line(aes(linetype=doc_filter)) -->
<!-- ``` -->



#### Experiment 2. High-depth samples with GL2 with and without 3x depth filter

<!-- Read in data table -->
<!-- ```{r} -->
<!-- DSdata2 = read.csv("GWhet_GL2_DSexperiment2.csv", h=T, fill=T, stringsAsFactors=T, fileEncoding="latin1") -->
<!-- ``` -->


<!-- How does het change with decreasing depth of coverage for a given sample? -->

<!-- ```{r} -->
<!-- F3 = ggplot(data=DSdata2[DSdata2$doc_filter == "ds" | DSdata2$doc_filter == "original" ,], aes(depth, het, colour=sample)) + geom_point() + geom_line() + -->
<!--   ylim(limits=c(0,4e-4)) + ggtitle("Downsampling test with a 3x minimum depth per site") + -->
<!--   xlim(limits=c(0,23)) -->

<!-- F4 = ggplot(data=DSdata2[DSdata2$doc_filter == "noFilter_ds" | DSdata2$doc_filter == "original",], aes(depth, het, colour=sample)) + geom_point() + geom_line() + -->
<!--   ylim(limits=c(0,4e-4)) + ggtitle("Downsampling test without filtering depth per site ") + -->
<!--   xlim(limits=c(0,23)) -->

<!-- F3 -->
<!-- F4 -->

<!-- ``` -->




<!-- Taking the het at the original depth as a reference, here are the differences that the het estimates at decreasing depths show -->

<!-- ```{r} -->
<!-- ggplot(DSdata2, aes(depth, diff, colour=sample)) + geom_point() + geom_line(aes(linetype=doc_filter)) -->
<!-- ``` -->

At depths <5x, filtering out sites with depth below 3x improves the het estimates.



#### Experiment 3. High and medium-depth samples with a 5x filter on sites

<!-- Read in data table -->
<!-- ```{r} -->
<!-- DSdata3 = read.csv("GWhet_GL2_DSexperiment3.csv", h=T, fill=T, stringsAsFactors=T, fileEncoding="latin1") -->
<!-- ``` -->


<!-- How does het change with decreasing depth of coverage for a given sample? -->

<!-- ```{r} -->
<!-- F6 = ggplot(data=DSdata3, aes(depth, het, colour=sample)) + geom_point() + geom_line(aes(linetype=depth_category)) + -->
<!--   ylim(limits=c(0,4e-4)) + ggtitle("Downsampling test with a 5x minimum depth per site") + -->
<!--   xlim(limits=c(0,23)) -->

<!-- F6 -->
<!-- ``` -->





### Depth versus het across the 4 downsampling experiments


Read in data table
```{r}
DSdataAll = read.csv("GWhet_DSexperiments0-1-2-3.csv", h=T, fill=T, stringsAsFactors=T, fileEncoding="latin1")
```

Set the order of the experiments for plotting
```{r}
DSdataAll$doc_filter <- factor(DSdataAll$doc_filter, levels=c("GL1-no_filter","GL2-no_filter","GL2-3x_filter","GL2-5x_filter"))
```

Visualise
```{r}
DS = ggplot(data=DSdataAll, aes(depth, het, colour=sample)) + geom_point(aes(shape=depth_category)) + geom_line() + theme_bw() +
  ylim(limits=c(0,4e-4)) +
  xlim(limits=c(0,23)) +
  facet_wrap(~ doc_filter, nrow=2, ncol=2)

DS
```



```{r}
pdf("WR_GWhet_DSexp_comparison.pdf", height=7, width=9, useDingbats = F)
DS
dev.off
```





######################################################################################

## Temporal comparisons with the different Het estimates


#### Individual heterozygosity across groups with different estimates of Het. Comparison

<!-- ```{r} -->
<!--   A = ggplot(data, aes(time_window, uncorrected_gw_het)) + geom_violin(aes(colour=time_window, fill=time_window), lwd=.3, alpha=.4) + ggtitle(label="GWhet with GL1") + -->
<!--   geom_jitter(colour='gray40', shape=16, position=position_jitter(0.11), cex=.6, alpha=.7) + -->
<!--    theme_bw() + theme(legend.position = "none", axis.text=element_text(size=7, colour='gray10'), axis.title=element_text(size=7), -->
<!--                       panel.grid.major=(element_line(size=.12, colour='gray80'))) + -->
<!--    stat_compare_means(paired=F, method = "wilcox.test", comparisons= list(c("NWR1", "NWR2"), c("SWR1", "SWR2"))) -->
<!--  #+ geom_text_repel(data=data, aes(label=sample_name), segment.size=.15, size=2) -->


<!--  B = ggplot(data, aes(time_window, corrected_gw_het)) + geom_violin(aes(colour=time_window, fill=time_window), lwd=.3, alpha=.4) + ggtitle(label="GWhet with GL1 corrected") + -->
<!--    geom_jitter(colour='gray40', shape=16, position=position_jitter(0.11), cex=.6, alpha=.7) + -->
<!--    theme_bw() + theme(legend.position = "none", axis.text=element_text(size=7, colour='gray10'), axis.title=element_text(size=7), -->
<!--                       panel.grid.major=(element_line(size=.12, colour='gray80'))) + -->
<!--      stat_compare_means(paired=F, method = "wilcox.test", comparisons= list(c("NWR1", "NWR2"), c("SWR1", "SWR2"))) -->
<!--  #+ geom_text_repel(data=data, aes(label=sample_name), segment.size=.15, size=2) -->



<!--  C = ggplot(data, aes(time_window, gw_het_GL2)) + geom_violin(aes(colour=time_window, fill=time_window), lwd=.3, alpha=.4) + ggtitle(label="GWhet with GL2") + -->
<!--    geom_jitter(colour='gray40', shape=16, position=position_jitter(0.11), cex=.6, alpha=.7) + -->
<!--    theme_bw() + theme(legend.position = "none", axis.text=element_text(size=7, colour='gray10'), axis.title=element_text(size=7), -->
<!--                       panel.grid.major=(element_line(size=.12, colour='gray80'))) + -->
<!--      stat_compare_means(paired=F, method = "wilcox.test", comparisons= list(c("NWR1", "NWR2"), c("SWR1", "SWR2"))) -->
<!--  #+ geom_text_repel(data=data, aes(label=sample_name), segment.size=.15, size=2) -->


<!--  D = ggplot(data, aes(time_window, gw_het_GL2_3x)) + geom_violin(aes(colour=time_window, fill=time_window), lwd=.3, alpha=.4) + ggtitle(label="GWhet with GL2 and 3x min DoC") + -->
<!--    geom_jitter(colour='gray40', shape=16, position=position_jitter(0.11), cex=.6, alpha=.7) + -->
<!--    theme_bw() + theme(legend.position = "none", axis.text=element_text(size=7, colour='gray10'), axis.title=element_text(size=7), -->
<!--                       panel.grid.major=(element_line(size=.12, colour='gray80'))) + -->
<!--      stat_compare_means(paired=F, method = "wilcox.test", comparisons= list(c("NWR1", "NWR2"), c("SWR1", "SWR2"))) + -->
<!--    geom_text_repel(data=data, aes(label=lab_ID), segment.size=.15, size=2) -->
<!-- ``` -->

<!-- ```{r} -->
<!--  A -->
<!--  B -->
<!--  C -->
<!--  D -->
<!-- ``` -->

<!-- ```{r eval=FALSE, include=FALSE} -->
<!--  pdf("WR_Het_GLcomparisons.pdf", height=7, useDingbats = F) -->
<!--  plot_grid(A, B, C, D, nrow=2, ncol=2, labels=c('A','B','C','D')) -->
<!--  dev.off -->
<!-- ``` -->



### Het comparisons between temporal groups with the (so far) best Het estimate: GL2, <3x ErTv (corrected)

```{r}
# plot het values per time window
gw_het = ggplot(data, aes(time_window, gw_het_GL2_3x_ErTv)) + 
  theme_bw() + theme(legend.position = "none", axis.text=element_text(size=7, colour='gray10'), axis.title.y=element_text(size=7), 
                     panel.grid.major=(element_line(size=.12, colour='gray80')))
  
  
# plot violin per group
gw_het = gw_het +  geom_violin(aes(colour=time_window, fill=time_window), lwd=.3, alpha=.4) +
  
  # add scatter points per group
  geom_jitter(colour='gray40', shape=16, position=position_jitter(0.11), cex=.6, alpha=.7) + 
  
  # add colours and filling colours
  scale_fill_manual(values= (c("gold3", "darkorange", "royalblue4", "steelblue3"))) + 
  scale_color_manual(values= (c("gold3", "darkorange", "royalblue4", "steelblue3"))) +
  
  # add stats and an unpaired wilcox test to compare the medians
  stat_summary(fun=median, geom="crossbar", colour='black', width=.12, lwd=.3) +
  
  stat_summary(fun=mean, fun.min = function (gw_het_GL2_3x_ErTv) mean(gw_het_GL2_3x_ErTv) - sd(gw_het_GL2_3x_ErTv), 
               fun.max = function(gw_het_GL2_3x_ErTv) mean(gw_het_GL2_3x_ErTv) + sd(gw_het_GL2_3x_ErTv), geom = "pointrange" , size=.12, stroke=.4, col="black") +
  
  stat_compare_means(paired=F, method = "wilcox.test", comparisons= list(c("NWR1", "NWR2"), c("SWR1", "SWR2")), label.y=c(0.00024, 0.00020), size=2.5) +
  
  # embellish
  scale_y_continuous(limits=c(0.00007, 0.00025),labels = function(x) format(x, scientific = FALSE)) +
  
  
  labs(x=NULL, y="Genome-wide heterozygosity (tv)") + geom_text_repel(data=data, aes(label=lab_ID), segment.size=.15, size=2)

gw_het
```




#### Now excluding the 4 samples of average depth of coverage <5x

```{r}
# plot het values per time window
gw_het = ggplot(data=subset(data, lab_ID!='mwr_TG0450' & lab_ID!='mwr_TG0451' & lab_ID!='mwr_TG0456' & lab_ID!='mwr_TGF01'), aes(time_window, gw_het_GL2_3x_ErTv)) + 
  theme_bw() + theme(legend.position = "none", axis.text=element_text(size=7, colour='gray10'), axis.title.y=element_text(size=7), 
                     panel.grid.major=(element_line(size=.12, colour='gray80')))
  
  
# plot violin per group
gw_het = gw_het +  geom_violin(aes(colour=time_window, fill=time_window), lwd=.3, alpha=.4) +
  
  # add scatter points per group
  geom_jitter(colour='gray40', shape=16, position=position_jitter(0.11), cex=.6, alpha=.7) + 
  
  # add colours and filling colours
  scale_fill_manual(values= (c("gold3", "darkorange", "royalblue4", "steelblue3"))) + 
  scale_color_manual(values= (c("gold3", "darkorange", "royalblue4", "steelblue3"))) +
  
  # add stats and an unpaired wilcox test to compare the medians
  stat_summary(fun=median, geom="crossbar", colour='black', width=.12, lwd=.3) +
  
  stat_summary(fun=mean, fun.min = function (gw_het_GL2_3x_ErTv) mean(gw_het_GL2_3x_ErTv) - sd(gw_het_GL2_3x_ErTv), 
               fun.max = function(gw_het_GL2_3x_ErTv) mean(gw_het_GL2_3x_ErTv) + sd(gw_het_GL2_3x_ErTv), geom = "pointrange" , size=.12, stroke=.4, col="black") +
  
  stat_compare_means(paired=F, method = "wilcox.test", comparisons = list(c("NWR1", "NWR2"), c("SWR1", "SWR2")), method.args = list(alternative = "greater"), label.y = c(0.00024, 0.00020), size=2.5) +
  
  # embellish
  scale_y_continuous(limits=c(0.00007, 0.00025),labels = function(x) format(x, scientific = FALSE)) +
  
  
  labs(x=NULL, y="Genome-wide heterozygosity (tv)") + geom_text_repel(data=data, aes(label=lab_ID), segment.size=.15, size=2)

gw_het
```



### GW het stats and delta estimators with the subsetted dataset


Summary statistics for gw_het across the 4 groups
```{r}
# for all samples
data %>%
  group_by(time_window) %>%
  summarize(min=min(gw_het_GL2_3x_ErTv), max=max(gw_het_GL2_3x_ErTv), median=median(gw_het_GL2_3x_ErTv))

# excluding those of depth of coverage below 4x
data %>%
  subset(depth_of_coverage > 5) %>%
  group_by(time_window) %>%
  summarize(min=min(gw_het_GL2_3x_ErTv), max=max(gw_het_GL2_3x_ErTv), median=median(gw_het_GL2_3x_ErTv))
```


Make a subset of the data without the low depth samples for further statistical testing
```{r}
data5x = data %>%
  subset(depth_of_coverage > 5)
```



### Statistical comparison of gw_het median between pre- and post-bottleneck samples for each subspecies

```{r}
ggplot(data5x, aes(gw_het_GL2_3x_ErTv, group=time_window, fill=time_window)) + geom_histogram(alpha=0.5, binwidth=0.000005, position = "identity") #+ geom_density(alpha=0.2)
```



Making a dataframe per group (subspecies and time window)
```{r}
nwr1_5x = data5x[data5x$time_window == "NWR1",]
nwr2_5x = data5x[data5x$time_window == "NWR2",]
swr1_5x = data5x[data5x$time_window == "SWR1",]
swr2_5x = data5x[data5x$time_window == "SWR2",]
```


Comparison NWR1-NWR2. Testing whether Het in NWR2 is significantly smaller than that of NWR1
```{r}
# the two-sided test reports if there is a significant difference between the distributions, on both sides of the distribution
wilcox.test(nwr1_5x$gw_het_GL2_3x_ErTv, nwr2_5x$gw_het_GL2_3x_ErTv, paired = F, alternative=c("two.sided"))

# the left test reports if the distribution of Het of NWR1 is to the left of that of NWR2 (i.e. NWR1 smaller than NWR2)
wilcox.test(nwr1_5x$gw_het_GL2_3x_ErTv, nwr2_5x$gw_het_GL2_3x_ErTv, paired = F, alternative=c("less")) 

# the right test reports is NWR1 is to the right (larger) than NWR2 Het distribution
wilcox.test(nwr1_5x$gw_het_GL2_3x_ErTv, nwr2_5x$gw_het_GL2_3x_ErTv, paired = F, alternative=c("greater"))
```


Comparison SWR1-SWR2
```{r}
# the two-sided test reports if there is a significant difference between the distributions, on both sides of the distribution
wilcox.test(swr1_5x$gw_het_GL2_3x_ErTv, swr2_5x$gw_het_GL2_3x_ErTv, paired = F, alternative=c("two.sided"))

# the left test reports if the distribution of Het of SWR1 is to the left of that of SWR2 (i.e. SWR1 smaller than SWR2)
wilcox.test(swr1_5x$gw_het_GL2_3x_ErTv, swr2_5x$gw_het_GL2_3x_ErTv, paired = F, alternative=c("less"))

# the right test reports is SWR1 is to the right (larger) than SWR2 Het distribution
wilcox.test(swr1_5x$gw_het_GL2_3x_ErTv, swr2_5x$gw_het_GL2_3x_ErTv, paired = F, alternative=c("greater"))
#wilcox.test(swr2_5x$gw_het_GL2_3x_ErTv, swr1_5x$gw_het_GL2_3x_ErTv, paired = F, alternative=c("less")) #equivalent test
```

##################

#### Statistical tests for the whole sample set (n=52)

Making a dataframe per group (subspecies and time window)
```{r}
nwr1 = data[data$time_window == "NWR1",]
nwr2 = data[data$time_window == "NWR2",]
swr1 = data[data$time_window == "SWR1",]
swr2 = data[data$time_window == "SWR2",]
```


Comparison NWR1-NWR2. Testing whether Het in NWR2 is significantly smaller than that of NWR1
```{r}
# the two-sided test reports if there is a significant difference between the distributions, on both sides of the distribution
wilcox.test(nwr1$gw_het_GL2_3x_ErTv, nwr2$gw_het_GL2_3x_ErTv, paired = F, alternative=c("two.sided"))

# the left test reports if the distribution of Het of NWR1 is to the left of that of NWR2 (i.e. NWR1 smaller than NWR2)
wilcox.test(nwr1$gw_het_GL2_3x_ErTv, nwr2$gw_het_GL2_3x_ErTv, paired = F, alternative=c("less")) 

# the right test reports is NWR1 is to the right (larger) than NWR2 Het distribution
wilcox.test(nwr1$gw_het_GL2_3x_ErTv, nwr2$gw_het_GL2_3x_ErTv, paired = F, alternative=c("greater"))
```


Comparison SWR1-SWR2
```{r}
# the two-sided test reports if there is a significant difference between the distributions, on both sides of the distribution
wilcox.test(swr1$gw_het_GL2_3x_ErTv, swr2$gw_het_GL2_3x_ErTv, paired = F, alternative=c("two.sided"))

# the left test reports if the distribution of Het of SWR1 is to the left of that of SWR2 (i.e. SWR1 smaller than SWR2)
wilcox.test(swr1$gw_het_GL2_3x_ErTv, swr2$gw_het_GL2_3x_ErTv, paired = F, alternative=c("less"))

# the right test reports is SWR1 is to the right (larger) than SWR2 Het distribution
wilcox.test(swr1$gw_het_GL2_3x_ErTv, swr2$gw_het_GL2_3x_ErTv, paired = F, alternative=c("greater"))
#wilcox.test(swr2_5x$gw_het_GL2_3x_ErTv, swr1_5x$gw_het_GL2_3x_ErTv, paired = F, alternative=c("less")) #equivalent test
```















